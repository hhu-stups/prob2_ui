
\documentclass[11pt]{article}
% Packages
\usepackage{color}
\usepackage{listings}
\usepackage{tabularx}
\usepackage{longtable}
\usepackage[table]{xcolor}
\usepackage{colortbl}
\usepackage{tablestyles}
\usepackage{float}
\usepackage[style=1]{mdframed}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{changepage}
\usepackage{ragged2e, lipsum}
\usepackage{caption, booktabs}

\lstset{literate=
		{∈}{$\in$}1
		{⇒}{$\Rightarrow$}1
		{≠}{$\neq$}1
		{∀}{$\forall$}1
		{‥}{$\cdot\cdot$}1
}

\lstset{ %
	language=C++,                % choose the language of the code
	basicstyle=\footnotesize,       % the size of the fonts that are used for the code
	numbers=left,                   % where to put the line-numbers
	numberstyle=\footnotesize,      % the size of the fonts that are used for the line-numbers
	stepnumber=1,                   % the step between two line-numbers. If it is 1 each line will be numbered
	numbersep=5pt,                  % how far the line-numbers are from the code
	backgroundcolor=\color{white},  % choose the background color. You must add \usepackage{color}
	showspaces=false,               % show spaces adding particular underscores
	showstringspaces=false,         % underline spaces within strings
	showtabs=false,                 % show tabs within strings adding particular underscores
	frame=single,           % adds a frame around the code
	tabsize=2,          % sets default tabsize to 2 spaces
	captionpos=b,           % sets the caption-position to bottom
	breaklines=true,        % sets automatic line breaking
	breakatwhitespace=false,    % sets if automatic breaks should only happen at whitespace
	escapeinside={\%*}{*)}          % if you want to add a comment within your code
}
\lstnewenvironment{tabularlstlisting}[1][]
{%
	\lstset{aboveskip=-2ex,belowskip=-3ex,#1}%
}
{}

% Packages
% Document
\begin{document}
	\section{Projekt}
	\section{TrafficLight}
\subsection{Model Code}
\begin{lstlisting}[caption = TrafficLight MCH Code]
	MACHINE TrafficLight

SETS colors = {red, redyellow, yellow, green}

VARIABLES tl_cars, tl_peds

INVARIANT tl_cars : colors &
	  tl_peds : {red, green} &
	  (tl_peds = red or
	  tl_cars = red)
              
INITIALISATION  tl_cars := red; tl_peds := red
	
OPERATIONS

cars_ry =
	SELECT tl_cars = red & tl_peds = red THEN
		tl_cars := redyellow
	END;

cars_y =
	SELECT tl_cars = green & tl_peds = red THEN
		tl_cars := yellow
	END;

cars_g =
	SELECT tl_cars = redyellow & tl_peds = red THEN
		tl_cars := green
	END;

cars_r =
	SELECT tl_cars = yellow & tl_peds = red THEN
		tl_cars := red
	END;

peds_r =
	SELECT tl_peds = green & tl_cars = red THEN
		tl_peds := red
	END;

peds_g =
	SELECT tl_peds = red & tl_cars = red THEN
		tl_peds := green
	END
      
END
\end{lstlisting}
\subsection{Model Checking}
\tablestyle[sansbold]
\begin{longtable}{*{2}{p{0.45\textwidth}}}
	\theadstart
		\thead Modelchecking Item &
		\thead Modelchecking Result\\
	\endfirsthead
	\tsubheadstart
		\thead Modelchecking Item &
		\thead Modelchecking Result\\
	\endhead
		\rowcolor{white}\caption{Modelchecking Items and Results}\\
	\endlastfoot
	\tbody
		Gemischte Breiten-/Tiefensuche, Invarianten überprüfen& Modelchecking not solved \\
Gemischte Breiten-/Tiefensuche, Deadlocks finden& Modelchecking not solved \\

\tend
\end{longtable}

\subsection{LTL Model Checking}
\tablestyle[sansbold]
\begin{longtable}{*{2}{p{0.45\textwidth}}}
	\theadstart
		\thead LTL Formular &
		\thead Status\\
	\endfirsthead
	\tsubheadstart
		\thead LTL Formular &
		\thead Status\\
	\endhead
		\rowcolor{white}\caption{LTL Formulars and Results}\\
	\endlastfoot
	\tbody
		\begin{tabularlstlisting}
G{tl_cars = red or tl_peds = red}
\end{tabularlstlisting} & Formular not Solved \\
\begin{tabularlstlisting}
G{tl_cars = red}
\end{tabularlstlisting} & Formular not Solved \\

	\tend
\end{longtable}
\tablestyle[sansbold]
\begingroup
\setlength{\LTleft}{-\textwidth plus -1fill}
\setlength{\LTright}{\LTleft}
\begin{longtable}{p{0.3\textwidth}p{0.3\textwidth}p{0.3\textwidth}}
	\theadstart
	\thead Pattern Name &
	\thead Code &
	\thead Result\\
	\endfirsthead
	\tsubheadstart
	\thead Pattern Name &
	\thead Code &
	\thead Result\\
	\endhead
	\rowcolor{white}\caption{LTL Patterns and Results}\\
	\endlastfoot
	\tbody

\tend
\end{longtable}




\subsection{Symbolic Model Checking}
\tablestyle[sansbold]
\begingroup
\setlength{\LTleft}{-\textwidth plus -1fill}
\setlength{\LTright}{\LTleft}
\begin{longtable}{p{0.45\textwidth}p{0.3\textwidth}p{0.3\textwidth}}
	\theadstart
		\thead Symbolic Type&
		\thead Configuration &
		\thead Result\\
	\endfirsthead
	\tsubheadstart
		\thead Symbolic Type&
		\thead Configuration &
	\thead Result\\
	\endhead
		\rowcolor{white}\caption{Symbolic Formulars and Results}\\
	\endlastfoot
	\tbody
		 INVARIANT  &  & Formular not Solved \\
 DEADLOCK  & 1=1 & Formular not Solved \\
 CHECK\_WELL\_DEFINEDNESS  &  & Formular not Solved \\
 CHECK\_STATIC\_ASSERTIONS  &  & Formular not Solved \\
 INVARIANT  & cars\_g & Formular not Solved \\
 SYMBOLIC\_MODEL\_CHECK  & TINDUCTION & Formular not Solved \\
 FIND\_REDUNDANT\_INVARIANTS  &  & Formular not Solved \\

	\tend
\end{longtable}
\endgroup

\subsection{Traces}
\tablestyle[sansbold]
\begin{longtable}{ll}
	\rowcolor{white}\caption{TrafficLight\_Cars} \\
	\theadstart
		\thead Position &
		\thead Transition\\
	\endfirsthead
	\tsubheadstart
		\thead Position &
		\thead Transition\\
	\endhead
	\tbody
		0 & INITIALISATION \\
1 & cars\_ry \\
2 & cars\_g \\
3 & cars\_y \\
4 & cars\_r \\

	\tend
\end{longtable}
\tablestyle[sansbold]
\begin{longtable}{ll}
	\rowcolor{white}\caption{TrafficLight\_Peds} \\
	\theadstart
		\thead Position &
		\thead Transition\\
	\endfirsthead
	\tsubheadstart
		\thead Position &
		\thead Transition\\
	\endhead
	\tbody
		0 & INITIALISATION \\
1 & peds\_g \\
2 & peds\_r \\

	\tend
\end{longtable}



\section{PitmanController\_TIME\_MC\_v4}
\subsection{Model Code}
\begin{lstlisting}[caption = PitmanController\_TIME\_MC\_v4 MCH Code]
	MACHINE PitmanController_TIME_MC_v4

INCLUDES BlinkLamps_v3, Sensors, GenericTimersMC
/*
 The BlinkLamps machine takes care of flashing the lights and the
 remaining blinks (for tip blinking).
 The main machine only has to worry about setting active_blinkers and
 for setting the blinkers to continuous or tip-blinking
 v5 uses v3 BlinkLamps
*/


CONSTANTS
  pitman_direction /* "Convert Pitman position into blink direction" */
PROPERTIES
  pitman_direction = {Neutral |-> neutral_blink, Downward5 |-> left_blink, Downward7 |-> left_blink,
                      Upward5 |-> right_blink, Upward7 |-> right_blink}

INVARIANT
 /* "SAF-H1" */ (hazardWarningSwitchOn = switch_on => active_blinkers=BLINK_DIRECTION)
 /* "ELS-8: As long as the hazard warning light switch is pressed (active), all
          direction indicators flash synchronously. " */ &
 
  /* "SAF-H2" */ (hazardWarningSwitchOn = switch_off & remaining_blinks = -1
   => active_blinkers = {pitman_direction(pitmanArmUpDown)} ) &

  /* "SAF-H3" */ (pitmanArmUpDown:PITMAN_DIRECTION_BLINKING & engineOn=TRUE
   => {pitman_direction(pitmanArmUpDown)} <: active_blinkers) &
   
    /* "SAF-H4" */ (engineOn=FALSE & hazardWarningSwitchOn = switch_off => active_blinkers={})
   &
// new invariants required for Rodin Proof:

 /* "SAF-H0" */ (hazardWarningSwitchOn = switch_on ⇒ remaining_blinks = -1) &
 
 /* "SAF-H3b"*/ (pitmanArmUpDown ∈ PITMAN_DIRECTION_BLINKING & engineOn=TRUE
        ⇒ remaining_blinks = -1)

ASSERTIONS
/* "thm1" */ pitman_direction : PITMAN_POSITION --> DIRECTIONS

INITIALISATION
  AbsoluteSetDeadline(blink_deadline,500)
OPERATIONS
  ENV_Pitman_Tip_blinking_start(newPos) = 
  SELECT newPos : PITMAN_TIP_BLINKING &
     newPos /= pitmanArmUpDown THEN
     // ELS-2, ELS-5
     SET_Pitman_Tip_blinking_short(newPos);
     IF hazardWarningSwitchOn = switch_off
        /* "ELS-13: If the warning light is activated,
                 any tip-blinking will be ignored ..." */
        & engineOn = TRUE
       THEN
          SET_BlinkersOn(pitman_direction(newPos),3)
      END;
     AddDeadline(tip_deadline,500)
  END;
  

  RTIME_Tip_blinking_Timeout(delta) =
   SELECT
     /* "grdTip" */ delta ∈ 0‥500
   THEN
     IF pitmanArmUpDown : PITMAN_TIP_BLINKING & remaining_blinks > 1 &
        active_blinkers = {pitman_direction(pitmanArmUpDown)} THEN
        // after 0.5 seconds a Tip blinking is cancelled and replaced by a continuous blinking
        // ELS-4: If the driver holds the pitman arm for more than 0.5 seconds in position "tip-blinking left",
        // flashing cycles are initiated for all direction
        // indicators on the left (see Req. ELS-1) until the pitman arm leaves the position "tip-blinking left".
       SET_RemainingBlinks(-1)
     END;
     IncreaseTimeUntilDeadline(tip_deadline,delta)
  END;
  
  RTIME_BlinkerOn(delta) =
   SELECT
     /* "grdTip" */ delta ∈ 0‥500
   THEN
     TIME_BlinkerOn;
     IncreaseTimeUntilCyclicDeadline(blink_deadline,delta,500)
  END;
  
  RTIME_BlinkerOff(delta) =
   SELECT
     /* "grdTip" */ delta ∈ 0‥500
   THEN
     TIME_BlinkerOff;
     IncreaseTimeUntilCyclicDeadline(blink_deadline,delta,500)
  END;
  
  RTIME_Nothing(delta,newOnCycle) =
   SELECT
     /* "grdDelta" */ delta ∈ 0‥500 &
     newOnCycle : BOOL
   THEN
     TIME_Nothing(newOnCycle);
     IncreaseTimeUntilCyclicDeadline(blink_deadline,delta,100)
  END;
  
  RTIME_Passes(delta) = SELECT delta : {100}
   THEN
    IncreaseTime(delta)
  END;
  
  ENV_Turn_EngineOn =
  BEGIN
    SET_EngineOn;
    IF pitmanArmUpDown :PITMAN_DIRECTION_BLINKING &
       hazardWarningSwitchOn = switch_off THEN
       SET_BlinkersOn(pitman_direction(pitmanArmUpDown), -1)
    END
  END;
  
  ENV_Turn_EngineOff =
  BEGIN
    SET_EngineOff;
    IF hazardWarningSwitchOn = switch_off
     /* "ELS-8 As long as the hazard warning light switch is pressed (active),
              all direction indicators flash synchronously." */
              // TO DO: pluse ratio 1:2 if ignition key is in lock
    THEN
         SET_AllBlinkersOff
    END
  END;
  
  ENV_Pitman_DirectionBlinking (newPos) =
  // corresponds to pitmanArmUpDown = 2 or 4 (Upward/Downward7)
  // ELS-1, ELS-5
  PRE newPos : PITMAN_POSITION & newPos /= pitmanArmUpDown THEN
     IF hazardWarningSwitchOn = switch_off & engineOn = TRUE THEN
         SET_BlinkersOn(pitman_direction(newPos), -1)
     END;
     SET_Pitman_DirectionBlinking(newPos)
  END;
  
  ENV_Pitman_Reset_to_Neutral =
  // ELS-1, ELS-5
  BEGIN
     SET_Pitman_Reset_to_Neutral;
     IF hazardWarningSwitchOn = switch_off & remaining_blinks = -1 THEN
         SET_AllBlinkersOff
     END
  END;
  
  
  
  ENV_Hazard_blinking(newSwitchPos) = SELECT newSwitchPos : SWITCH_STATUS & newSwitchPos /= hazardWarningSwitchOn THEN
  // ELS-1, ELS-5
      IF newSwitchPos = switch_on // hazardWarningSwitchOn = switch_off
      THEN
         SET_AllBlinkersOn
       ELSIF newSwitchPos = switch_off // hazardWarningSwitchOn = switch_on
       THEN
         IF pitmanArmUpDown = Neutral or engineOn = FALSE THEN
            SET_AllBlinkersOff
         ELSIF  pitmanArmUpDown /: PITMAN_DIRECTION_BLINKING THEN
            // ELS-12 : When hazard warning is deactivated again, the pitman arm is in
            //  position \direction blinking left" or \direction blinking right" ignition is On,
            //  the direction blinking cycle should be started (see Req. ELS-1).
            SET_AllBlinkersOff
         ELSE
            SET_BlinkersOn(pitman_direction(pitmanArmUpDown),remaining_blinks) // remaining_blinks must be ≠ 0
         END
      END;
      SET_Hazard_blinking(newSwitchPos)
  END
  
END

\end{lstlisting}
\subsection{Model Checking}
\tablestyle[sansbold]
\begin{longtable}{*{2}{p{0.45\textwidth}}}
	\theadstart
		\thead Modelchecking Item &
		\thead Modelchecking Result\\
	\endfirsthead
	\tsubheadstart
		\thead Modelchecking Item &
		\thead Modelchecking Result\\
	\endhead
		\rowcolor{white}\caption{Modelchecking Items and Results}\\
	\endlastfoot
	\tbody
		Gemischte Breiten-/Tiefensuche, Invarianten überprüfen& Modelchecking not solved \\
Gemischte Breiten-/Tiefensuche, Deadlocks finden& Modelchecking not solved \\

\tend
\end{longtable}

\subsection{LTL Model Checking}
\tablestyle[sansbold]
\begin{longtable}{*{2}{p{0.45\textwidth}}}
	\theadstart
		\thead LTL Formular &
		\thead Status\\
	\endfirsthead
	\tsubheadstart
		\thead LTL Formular &
		\thead Status\\
	\endhead
		\rowcolor{white}\caption{LTL Formulars and Results}\\
	\endlastfoot
	\tbody
		\begin{tabularlstlisting}
G{engineOn = TRUE}
\end{tabularlstlisting} & Formular not Solved \\

	\tend
\end{longtable}
\tablestyle[sansbold]
\begingroup
\setlength{\LTleft}{-\textwidth plus -1fill}
\setlength{\LTright}{\LTleft}
\begin{longtable}{p{0.3\textwidth}p{0.3\textwidth}p{0.3\textwidth}}
	\theadstart
	\thead Pattern Name &
	\thead Code &
	\thead Result\\
	\endfirsthead
	\tsubheadstart
	\thead Pattern Name &
	\thead Code &
	\thead Result\\
	\endhead
	\rowcolor{white}\caption{LTL Patterns and Results}\\
	\endlastfoot
	\tbody

\tend
\end{longtable}





\subsection{Traces}
\tablestyle[sansbold]
\begin{longtable}{ll}
	\rowcolor{white}\caption{PitmanController\_TIME\_v3\_Trace7} \\
	\theadstart
		\thead Position &
		\thead Transition\\
	\endfirsthead
	\tsubheadstart
		\thead Position &
		\thead Transition\\
	\endhead
	\tbody
		0 & SETUP\_CONSTANTS \\
1 & INITIALISATION \\
2 & RTIME\_Nothing \\
3 & RTIME\_Nothing \\
4 & RTIME\_Nothing \\
5 & RTIME\_Nothing \\
6 & RTIME\_Nothing \\
7 & RTIME\_Nothing \\
8 & RTIME\_Nothing \\
9 & RTIME\_Nothing \\
10 & RTIME\_Nothing \\
11 & RTIME\_Nothing \\
12 & RTIME\_Nothing \\
13 & RTIME\_Nothing \\
14 & RTIME\_Nothing \\
15 & RTIME\_Nothing \\
16 & RTIME\_Nothing \\
17 & RTIME\_Nothing \\
18 & ENV\_Turn\_EngineOn \\
19 & RTIME\_Nothing \\
20 & RTIME\_Nothing \\
21 & RTIME\_Nothing \\
22 & RTIME\_Nothing \\
23 & RTIME\_Nothing \\
24 & RTIME\_Nothing \\
25 & RTIME\_Nothing \\
26 & RTIME\_Nothing \\
27 & RTIME\_Nothing \\
28 & RTIME\_Nothing \\
29 & RTIME\_Nothing \\
30 & RTIME\_Nothing \\
31 & RTIME\_Nothing \\
32 & RTIME\_Nothing \\
33 & RTIME\_Nothing \\
34 & RTIME\_Nothing \\
35 & RTIME\_Nothing \\
36 & RTIME\_Nothing \\
37 & RTIME\_Nothing \\
38 & RTIME\_Nothing \\
39 & ENV\_Pitman\_DirectionBlinking \\
40 & RTIME\_BlinkerOn \\
41 & RTIME\_BlinkerOff \\
42 & RTIME\_BlinkerOn \\
43 & RTIME\_Passes \\
44 & RTIME\_Passes \\
45 & ENV\_Pitman\_Reset\_to\_Neutral \\
46 & RTIME\_Nothing \\
47 & RTIME\_Nothing \\
48 & RTIME\_Nothing \\
49 & RTIME\_Nothing \\
50 & RTIME\_Nothing \\
51 & RTIME\_Nothing \\
52 & RTIME\_Nothing \\
53 & RTIME\_Nothing \\
54 & RTIME\_Nothing \\
55 & RTIME\_Nothing \\
56 & RTIME\_Nothing \\
57 & RTIME\_Nothing \\
58 & RTIME\_Nothing \\
59 & RTIME\_Nothing \\
60 & RTIME\_Nothing \\
61 & RTIME\_Nothing \\
62 & RTIME\_Nothing \\
63 & RTIME\_Nothing \\
64 & RTIME\_Nothing \\
65 & RTIME\_Nothing \\
66 & RTIME\_Nothing \\
67 & RTIME\_Nothing \\
68 & RTIME\_Nothing \\
69 & RTIME\_Nothing \\
70 & RTIME\_Nothing \\
71 & RTIME\_Nothing \\
72 & RTIME\_Nothing \\
73 & RTIME\_Nothing \\
74 & RTIME\_Nothing \\
75 & RTIME\_Nothing \\
76 & RTIME\_Nothing \\
77 & RTIME\_Nothing \\
78 & RTIME\_Nothing \\
79 & RTIME\_Nothing \\
80 & RTIME\_Nothing \\
81 & RTIME\_Nothing \\
82 & RTIME\_Nothing \\
83 & RTIME\_Nothing \\
84 & RTIME\_Nothing \\
85 & RTIME\_Nothing \\
86 & RTIME\_Nothing \\
87 & RTIME\_Nothing \\
88 & RTIME\_Nothing \\
89 & RTIME\_Nothing \\
90 & RTIME\_Nothing \\
91 & ENV\_Pitman\_Tip\_blinking\_start \\
92 & RTIME\_BlinkerOn \\
93 & RTIME\_Passes \\
94 & ENV\_Pitman\_Reset\_to\_Neutral \\
95 & RTIME\_Tip\_blinking\_Timeout \\
96 & RTIME\_Passes \\
97 & RTIME\_BlinkerOff \\
98 & RTIME\_Passes \\
99 & RTIME\_Passes \\
100 & ENV\_Hazard\_blinking \\
101 & RTIME\_BlinkerOn \\
102 & RTIME\_BlinkerOff \\
103 & RTIME\_BlinkerOn \\
104 & RTIME\_BlinkerOff \\
105 & RTIME\_BlinkerOn \\
106 & RTIME\_Passes \\
107 & RTIME\_Passes \\
108 & ENV\_Pitman\_Tip\_blinking\_start \\
109 & RTIME\_Passes \\
110 & ENV\_Pitman\_Reset\_to\_Neutral \\
111 & RTIME\_BlinkerOff \\
112 & RTIME\_Tip\_blinking\_Timeout \\
113 & RTIME\_BlinkerOn \\
114 & RTIME\_Passes \\
115 & RTIME\_Passes \\
116 & ENV\_Hazard\_blinking \\
117 & RTIME\_Nothing \\
118 & RTIME\_Nothing \\
119 & RTIME\_Nothing \\
120 & RTIME\_Nothing \\
121 & RTIME\_Nothing \\

	\tend
\end{longtable}




\end{document}

